<%= form_for(@user) do |f| %>
          <%= render "shared/user_error_messages"%>
          
            <%=f.label :name,"ユーザー名" %>
            <%=f.text_field :name, class: 'form-control' %>
            
            <%=f.label :email,"メールアドレス"%>
            <%=f.email_field :email, class: 'form-control'%>
            
            <%=f.label :password,"パスワード"%>
            <%=f.password_field :password, class: 'form-control'%>
            
            <%=f.label :password_confirmation,"確認用パスワード"%>
            <%=f.password_field :password_confirmation, class: 'form-control'%>

            <%=f.label :message,"自己紹介メッセージ"%>
            <%=f.text_field :message, class: 'form-control'%>

            <%=f.label :img,"プロフィールアイコン"%></br>
            <img @user.img.url, id="img_prev" style="width:200px;height:200px;" if @user.img? >
            <%=f.file_field :img, id: "myfile" ,class: 'form-control'%>

            <br><%=f.submit yield(:button_text), class: "btn btn-primary"%>
<%end%>

<script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
<script>
$(function(){
  $('#myfile').change(function(e){
    //ファイルオブジェクトを取得する
    var file = e.target.files[0];
    var reader = new FileReader();

    //画像でない場合は処理終了
    if(file.type.indexOf("image") < 0){
      alert("画像ファイルを指定してください。");
      return false;
    }

    //アップロードした画像を設定する
    reader.onload = (function(file){
      return function(e){
        $("#img_prev").attr("src", e.target.result);
        $("#img_prev").attr("title", file.name);
      };
    })(file);
    reader.readAsDataURL(file);

  });
});
</script>